{"version":3,"file":"mine.js","sources":["pages/mine/mine.vue","../../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbWluZS9taW5lLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"mine-page\">\n    <!-- 顶部用户信息 -->\n    <view class=\"user-card\" @click=\"handleLogin\">\n      <image\n        class=\"avatar\"\n        :src=\"isLogin ? userInfo.avatar : defaultAvatar\"\n      />\n\n      <view class=\"user-info\">\n        <view class=\"nickname\">\n          {{ isLogin ? userInfo.name : '点击登录 / 注册' }}\n        </view>\n        <view v-if=\"isLogin\" class=\"desc\">\n          {{ userInfo.phone }}\n        </view>\n      </view>\n\n      <view v-if=\"!isLogin\" class=\"arrow\">›</view>\n    </view>\n\n    <!-- 功能列表 -->\n    <view class=\"menu-list\">\n      <view class=\"menu-item\" v-for=\"item in menus\" :key=\"item.title\">\n        <text>{{ item.title }}</text>\n        <text class=\"arrow\">›</text>\n      </view>\n    </view>\n\n    <!-- 退出登录 -->\n    <view v-if=\"isLogin\" class=\"logout\" @click=\"logout\">\n      退出登录\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref } from 'vue'\nimport { onShow } from '@dcloudio/uni-app'\n\nconst defaultAvatar =\n  'https://tse3-mm.cn.bing.net/th/id/OIP-C.MpGc1WMpmJATpTSKSG-3ogAAAA?w=163&h=176&c=7&r=0&o=7&cb=ucfimg2&pid=1.7&rm=3&ucfimg=1'\n\nconst isLogin = ref(false)\n\nconst userInfo = ref({\n  nickname: '',\n  phone: '',\n  avatar: defaultAvatar\n})\n\nconst menus = ref([\n  { title: '我的签到' },\n  { title: '账号与安全' },\n  { title: '上传人脸信息' }\n])\n\n/**\n * 页面显示时检查登录态\n */\nconst checkLogin = () => {\n  const cacheUser = uni.getStorageSync('userinfo')\n\n  if (cacheUser) {\n    isLogin.value = true\n    userInfo.value = {\n      ...cacheUser,\n      avatar: cacheUser.avatar || defaultAvatar\n    }\n  } else {\n    isLogin.value = false\n    userInfo.value = {\n      nickname: '',\n      phone: '',\n      avatar: defaultAvatar\n    }\n  }\n}\n\nconst handleLogin = () => {\n  if (isLogin.value) return\n\n  uni.navigateTo({\n    url: '/pages/login/login'\n  })\n}\n\nconst logout = () => {\n  uni.showModal({\n    title: '提示',\n    content: '确定退出登录吗？',\n    success: res => {\n      if (res.confirm) {\n        uni.removeStorageSync('userinfo')\n        checkLogin()\n      }\n    }\n  })\n}\n\n// ⭐ 关键：每次进入页面都会执行\nonShow(() => {\n  checkLogin()\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.mine-page {\n  min-height: 100vh;\n  background: #f6f7f8;\n  padding: 30rpx;\n}\n\n/* 用户卡片 */\n.user-card {\n  display: flex;\n  align-items: center;\n  background: #fff;\n  padding: 30rpx;\n  border-radius: 16rpx;\n  margin-bottom: 30rpx;\n}\n\n.avatar {\n  width: 120rpx;\n  height: 120rpx;\n  border-radius: 50%;\n  margin-right: 24rpx;\n}\n\n.user-info {\n  flex: 1;\n}\n\n.nickname {\n  font-size: 34rpx;\n  font-weight: 600;\n}\n\n.desc {\n  margin-top: 8rpx;\n  font-size: 24rpx;\n  color: #999;\n}\n\n.arrow {\n  font-size: 36rpx;\n  color: #ccc;\n}\n\n/* 菜单 */\n.menu-list {\n  background: #fff;\n  border-radius: 16rpx;\n  overflow: hidden;\n}\n\n.menu-item {\n  display: flex;\n  justify-content: space-between;\n  padding: 28rpx 30rpx;\n  font-size: 28rpx;\n  border-bottom: 1px solid #eee;\n}\n\n.menu-item:last-child {\n  border-bottom: none;\n}\n\n/* 退出 */\n.logout {\n  margin-top: 40rpx;\n  background: #fff;\n  text-align: center;\n  padding: 28rpx;\n  color: #ff3b30;\n  border-radius: 16rpx;\n  font-size: 30rpx;\n}\n</style>\n","import MiniProgramPage from 'D:/Projects/HBuilderX/SignInSystemMiniProgram/pages/mine/mine.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","onShow"],"mappings":";;AAwCA,MAAM,gBACJ;;;;AAEF,UAAM,UAAUA,cAAG,IAAC,KAAK;AAEzB,UAAM,WAAWA,cAAAA,IAAI;AAAA,MACnB,UAAU;AAAA,MACV,OAAO;AAAA,MACP,QAAQ;AAAA,IACV,CAAC;AAED,UAAM,QAAQA,cAAAA,IAAI;AAAA,MAChB,EAAE,OAAO,OAAQ;AAAA,MACjB,EAAE,OAAO,QAAS;AAAA,MAClB,EAAE,OAAO,SAAU;AAAA,IACrB,CAAC;AAKD,UAAM,aAAa,MAAM;AACvB,YAAM,YAAYC,cAAAA,MAAI,eAAe,UAAU;AAE/C,UAAI,WAAW;AACb,gBAAQ,QAAQ;AAChB,iBAAS,QAAQ;AAAA,UACf,GAAG;AAAA,UACH,QAAQ,UAAU,UAAU;AAAA,QAC7B;AAAA,MACL,OAAS;AACL,gBAAQ,QAAQ;AAChB,iBAAS,QAAQ;AAAA,UACf,UAAU;AAAA,UACV,OAAO;AAAA,UACP,QAAQ;AAAA,QACT;AAAA,MACF;AAAA,IACH;AAEA,UAAM,cAAc,MAAM;AACxB,UAAI,QAAQ;AAAO;AAEnBA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,MACT,CAAG;AAAA,IACH;AAEA,UAAM,SAAS,MAAM;AACnBA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,SAAO;AACd,cAAI,IAAI,SAAS;AACfA,0BAAG,MAAC,kBAAkB,UAAU;AAChC,uBAAY;AAAA,UACb;AAAA,QACF;AAAA,MACL,CAAG;AAAA,IACH;AAGAC,kBAAAA,OAAO,MAAM;AACX,iBAAY;AAAA,IACd,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;ACtGD,GAAG,WAAW,eAAe;"}